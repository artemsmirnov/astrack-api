swagger: '2.0'
schemes:
    - https
basePath: /api
info:
    title: 'astrack api'
    version: 1.0.0
tags:
  - name: user
    description: User operations
  - name: activity
    description: Activity management

paths:
    /users/singup:
        post:
            tags: [user]
            summary: Create new user
            operationId: userSignUp
            consumes: [application/json]
            produces: [application/json]
            parameters:
              - in: body
                name: body
                schema:
                    type: object
                    required: [username, password]
                    properties:
                        username:
                            type: string
                        password:
                            type: string
            responses:
                '201':
                    description: 'Created'
                    schema:
                        type: object
                        properties:
                            user:
                                $ref: '#/definitions/User'
                '400':
                    description: 'Invalid input'
                '422':
                    description: 'User exists'
    /users/signin:
        post:
            tags: [user]
            summary: Create new session user
            operationId: userSignIn
            consumes: [application/json]
            produces: [application/json]
            parameters:
              - in: body
                name: body
                schema:
                    type: object
                    required: [username, password]
                    properties:
                        username:
                            type: string
                        password:
                            type: string
            responses:
                '201':
                    description: 'Created'
                    schema:
                        type: object
                        properties:
                            user:
                                $ref: '#/definitions/User'
                '404':
                    description: 'User not found'
    /users/signout:
        post:
            tags: [user]
            summary: Sign out user
            operationId: userSignOut
            produces: [application/json]
            responses:
                '200':
                    description: 'Signed out'
                '403':
                    description: 'Not signed in'
    /users/me:
        get:
            tags: [user]
            summary: Get current user
            operationId: userGetMe
            produces: [application/json]
            responses:
                '200':
                    schema:
                        type: object
                        properties:
                            user:
                                $ref: '#/definitions/User'

    /activities:
        get:
            tags: [activity]
            summary: Get activities
            operationId: activityIndex
            produces: [application/json]
            responses:
                '200':
                    schema:
                        type: object
                        properties:
                            tracks:
                                type: array
                                items:
                                    $ref: '#/definitions/Activity'
        post:
            tags: [activity]
            summary: Create activity
            operationId: activityNew
            consumes: [application/json]
            produces: [application/json]
            parameters:
              - in: body
                name: body
                required: true
                schema:
                    type: object
                    required: [activity]
                    properties:
                        name:
                            type: string
            responses:
                '200':
                    schema:
                        type: object
                        properties:
                            activity:
                                $ref: '#/definitions/Activity'
                '400':
                    description: 'Invalid activity'

    /activities/{activityId}:
        delete:
            tags: [activity]
            summary: Delete activity
            operationId: activityDelete
            consumes: [application/json]
            produces: [application/json]
            parameters:
              - in: path
                name: activityId
                type: number
            responses:
                '200':
                    description: 'Deleted'

    /activities/{activityId}/logs:
        post:
            tags: [activity]
            summary: Create activity log
            operationId: activityLogNew
            consumes: [application/json]
            produces: [application/json]
            parameters:
              - in: path
                name: activityId
                type: number
              - in: body
                name: body
                required: true
                schema:
                    type: object
                    required: [date, duration]
                    properties:
                        date:
                            type: number
                        duration:
                            type: number

    /activities/{activityId}/logs/{logId}:
        delete:
            tags: [activity]
            summary: Delete activity log
            operationId: activityLogDelete
            consumes: [application/json]
            produces: [application/json]
            parameters:
              - in: path
                name: activityId
                type: number
              - in: path
                name: logId
                type: number
            responses:
                '200':
                    description: 'Deleted'

definitions:
    User:
        type: object
        properties:
            username:
                type: string
    Activity:
        type: object
        properties:
            id:
                type: number
            name:
                type: string
            logs:
                type: array
                items:
                    type: object
                    properties:
                        id:
                            type: string
                        summary:
                            type: string
                        date:
                            type: number
                        duration:
                            type: number